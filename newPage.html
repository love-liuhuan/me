<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <title>like you</title>
    <script type="text/javascript" src="http://apps.bdimg.com/libs/jquery/2.1.4/jquery.min.js"></script>
    <link type="text/css" href="./xc/style1.css" rel="stylesheet" />
    <style>
        html,
        body {
            width: 100%;
            height: 100%;
            margin: 0;
            padding: 0;
            overflow: hidden;
        }

        .back-home-btn {
            position: fixed;
            bottom: 40px;
            left: 50%;
            transform: translateX(-50%);
            z-index: 9999;
            background: transparent;
            border: none;
            cursor: pointer;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center; 
            padding: 0;
        }

        .back-home-btn span {
            color: #fff;
            font-size: 44px;
            margin: 0; 
            text-shadow: 0 0 10px rgba(255, 107, 129, 0.8), 0 2px 4px rgba(0,0,0,0.3);
            position: absolute; 
            top: 50%;
            transform: translateY(-50%);
        }

        .back-home-btn:hover svg {
            fill: #ff4757;
            transform: scale(1.1);
            transition: all 0.3s ease;
        }

        /* çˆ±å¿ƒé—ªçƒå‘å…‰æ•ˆæœ */
        .pulse-heart {
            /* åŸºç¡€å‘å…‰æ•ˆæœ */
            filter: drop-shadow(0 0 10px rgba(255, 107, 129, 0.8));
            /* é—ªçƒåŠ¨ç”» */
            animation: pulse-glow 2s infinite alternate;
        }

        /* å®šä¹‰é—ªçƒåŠ¨ç”» */
        @keyframes pulse-glow {
            0% {
                /* è¾ƒå¼±çš„å‘å…‰ */
                filter: drop-shadow(0 0 5px rgba(255, 107, 129, 0.3));
                fill: #ff6b81;
            }
            50% {
                /* ä¸­ç­‰å¼ºåº¦å‘å…‰ */
                filter: drop-shadow(0 0 15px rgba(255, 107, 129, 0.8));
                fill: #ff5267;
            }
            100% {
                /* æœ€å¼ºçš„å‘å…‰ */
                filter: drop-shadow(0 0 45px rgba(255, 107, 129, 1));
                fill: #ff384f;
            }
        }

        .container {
            width: 100%;
            height: 100%;
            margin: 0;
            padding: 0;
            background-color: #000000;
        }

        .love-subtitle {
            position: fixed; /* å›ºå®šåœ¨é¡µé¢ä¸­ï¼Œä¸éšæ»šåŠ¨ç§»åŠ¨ */
            top: 10%; /* è·ç¦»é¡¶éƒ¨10%ä½ç½®ï¼Œå¯è°ƒæ•´ */
            left: 50%;
            transform: translateX(-50%); /* æ°´å¹³å±…ä¸­ */
            z-index: 9999; /* å±‚çº§æœ€é«˜ï¼Œç¡®ä¿åœ¨3Dç›¸å†Œå’Œæ¨±èŠ±ä¹‹ä¸Š */
            font-family: "Microsoft YaHei", sans-serif; /* ä¼˜ç¾å­—ä½“ */
            font-size: 42px; /* å­—ä½“å¤§å°ï¼Œå¯è°ƒæ•´ */
            color: #ff6b81; /* ç²‰è‰²ç³»ï¼Œç¬¦åˆè¡¨ç™½æ°›å›´ */
            text-shadow: 0 0 10px rgba(255, 107, 129, 0.8); /* æ–‡å­—å‘å…‰æ•ˆæœ */
            opacity: 0; /* é»˜è®¤éšè— */
            transition: opacity 0.8s ease; /* æ¸æ˜¾æ¸éšè¿‡æ¸¡ */
            white-space: nowrap; /* é˜²æ­¢æ–‡å­—æ¢è¡Œ */
        }
    </style>
</head>
<body>
    <div class="love-subtitle" id="loveSubtitle"></div>

    <div class="m-main">
		<div class="player">
			<a href="javascript:void(0)" rel="external nofollow" rel="external nofollow" id="js-play">
				<img src="./img-one/å¼€å§‹.png" alt="æ’­æ”¾æŒ‰é’®" id="img1"/>
            </a>
			<a href="javascript:void(0)" rel="external nofollow" rel="external nofollow" id="js-pause">
				<img src="./img-one/æš‚åœ.png" alt="æš‚åœæŒ‰é’®" id="img2"/>
			</a>
			<div class="play-box">
				<div class="left">
					<p class="timeline"><span style=""></span></p>
					<div class="info">
						<span class="size">00:00</span>
						<span class="timeshow">00:00</span>
					</div>
				</div>
			</div>
		</div>
		<div class="video">
			<audio name="media" id="js-video">
  <source src="./mp3/forya.MP3" type="audio/mpeg">
</audio>
		</div>
	</div>
    <div id="jsi-cherry-container" class="container">
        <div class="box">
            <ul class="minbox">
                <li></li>
                <li></li>
                <li></li>
                <li></li>
                <li></li>
                <li></li>
            </ul>
            <ol class="maxbox">
                <li></li>
                <li></li>
                <li></li>
                <li></li>
                <li></li>
                <li></li>
            </ol>
        </div>
    </div>
    <script>
        $(function () {
            AudioControl('js-video');

            function AudioControl(id) {
                // éŸ³é¢‘æ§åˆ¶è¿›åº¦æ¡
                var audio = document.getElementById(id);
                $(audio).on('loadedmetadata', function () {
                    audio.pause();
                    // è¿›åº¦æ¡æ§åˆ¶
                    $(document).on('touchend', '.timeline', function (e) {
                        var x = e.originalEvent.changedTouches[0].clientX - this.offsetLeft;
                        var X = x < 0 ? 0 : x;
                        var W = $(this).width();
                        var place = X > W ? W : X;
                        audio.currentTime = (place / W).toFixed(2) * audio.duration;
                        $(this).children().css({
                            width: (place / W).toFixed(2) * 100 + "%"
                        })
                    });
                    // æ’­æ”¾
                    $(document).on('click', '#js-play', function () {
                        audio.play()
                        $('#img1').css("display","none");
                        $('#img2').css("display","block");
                    });
                    // æš‚åœ
                    $(document).on('click', '#js-pause', function () {
                        audio.pause()
                        $('#img1').css("display","block");
                        $('#img2').css("display","none");
                    });
                });
                setInterval(function () {
                    var currentTime = audio.currentTime;
                    setTimeShow(currentTime);
                }, 1000);
                // è®¾ç½®æ’­æ”¾æ—¶é—´
                function setTimeShow(t) {
                    t = Math.floor(t);
                    var playTime = secondToMin(audio.currentTime);
                    $(".size").html(playTime);
                    $('.timeshow').text(secondToMin(audio.duration));
                    $('.timeline').children().css({
                        width: (t / audio.duration).toFixed(4) * 100 + "%"
                    })
                }
                // è®¡ç®—æ—¶é—´
                function secondToMin(s) {
                    var MM = Math.floor(s / 60);
                    var SS = s % 60;
                    if (MM < 10)
                        MM = "0" + MM;
                    if (SS < 10)
                        SS = "0" + SS;
                    var min = MM + ":" + SS;
                    return min.split('.')[0];
                }
            }
        })
        var RENDERER = {
            INIT_CHERRY_BLOSSOM_COUNT: 30,
            MAX_ADDING_INTERVAL: 10,

            init: function () {
                this.setParameters();
                this.reconstructMethods();
                this.createCherries();
                this.render();
                if (
                    navigator.userAgent.match(
                        /(phone|pod|iPhone|iPod|ios|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i
                    )
                ) {
                    var box = document.querySelectorAll('.box')[0];
                    box.style.marginTop = '65%';
                }
            },
            setParameters: function () {
                this.$container = $('#jsi-cherry-container');
                this.width = this.$container.width();
                this.height = this.$container.height();
                this.context = $('<canvas />')
                    .attr({
                        width: this.width,
                        height: this.height
                    })
                    .appendTo(this.$container)
                    .get(0)
                    .getContext('2d');
                this.cherries = [];
                this.maxAddingInterval = Math.round(
                    (this.MAX_ADDING_INTERVAL * 1000) / this.width
                );
                this.addingInterval = this.maxAddingInterval;
            },
            reconstructMethods: function () {
                this.render = this.render.bind(this);
            },
            createCherries: function () {
                for (
                    var i = 0,
                        length = Math.round(
                            (this.INIT_CHERRY_BLOSSOM_COUNT * this.width) / 1000
                        ); i < length; i++
                ) {
                    this.cherries.push(new CHERRY_BLOSSOM(this, true));
                }
            },
            render: function () {
                requestAnimationFrame(this.render);
                this.context.clearRect(0, 0, this.width, this.height);

                this.cherries.sort(function (cherry1, cherry2) {
                    return cherry1.z - cherry2.z;
                });
                for (var i = this.cherries.length - 1; i >= 0; i--) {
                    if (!this.cherries[i].render(this.context)) {
                        this.cherries.splice(i, 1);
                    }
                }
                if (--this.addingInterval == 0) {
                    this.addingInterval = this.maxAddingInterval;
                    this.cherries.push(new CHERRY_BLOSSOM(this, false));
                }
            }
        };
        var CHERRY_BLOSSOM = function (renderer, isRandom) {
            this.renderer = renderer;
            this.init(isRandom);
        };
        CHERRY_BLOSSOM.prototype = {
            FOCUS_POSITION: 300,
            FAR_LIMIT: 600,
            MAX_RIPPLE_COUNT: 100,
            RIPPLE_RADIUS: 100,
            SURFACE_RATE: 0.5,
            SINK_OFFSET: 20,

            init: function (isRandom) {
                this.x = this.getRandomValue(
                    -this.renderer.width,
                    this.renderer.width
                );
                this.y = isRandom ?
                    this.getRandomValue(0, this.renderer.height) :
                    this.renderer.height * 1.5;
                this.z = this.getRandomValue(0, this.FAR_LIMIT);
                this.vx = this.getRandomValue(-2, 2);
                this.vy = -2;
                this.theta = this.getRandomValue(0, Math.PI * 2);
                this.phi = this.getRandomValue(0, Math.PI * 2);
                this.psi = 0;
                this.dpsi = this.getRandomValue(Math.PI / 600, Math.PI / 300);
                this.opacity = 0;
                this.endTheta = false;
                this.endPhi = false;
                this.rippleCount = 0;

                var axis = this.getAxis(),
                    theta =
                    this.theta +
                    (Math.ceil(
                            -(this.y + this.renderer.height * this.SURFACE_RATE) / this.vy
                        ) *
                        Math.PI) /
                    500;
                theta %= Math.PI * 2;

                this.offsetY =
                    40 * (theta <= Math.PI / 2 || theta >= (Math.PI * 3) / 2 ? -1 : 1);
                this.thresholdY =
                    this.renderer.height / 2 +
                    this.renderer.height * this.SURFACE_RATE * axis.rate;
                this.entityColor = this.renderer.context.createRadialGradient(
                    0,
                    40,
                    0,
                    0,
                    40,
                    80
                );
                this.entityColor.addColorStop(
                    0,
                    'hsl(330, 70%, ' + 50 * (0.3 + axis.rate) + '%)'
                );
                this.entityColor.addColorStop(
                    0.05,
                    'hsl(330, 40%,' + 55 * (0.3 + axis.rate) + '%)'
                );
                this.entityColor.addColorStop(
                    1,
                    'hsl(330, 20%, ' + 70 * (0.3 + axis.rate) + '%)'
                );
                this.shadowColor = this.renderer.context.createRadialGradient(
                    0,
                    40,
                    0,
                    0,
                    40,
                    80
                );
                this.shadowColor.addColorStop(
                    0,
                    'hsl(330, 40%, ' + 30 * (0.3 + axis.rate) + '%)'
                );
                this.shadowColor.addColorStop(
                    0.05,
                    'hsl(330, 40%,' + 30 * (0.3 + axis.rate) + '%)'
                );
                this.shadowColor.addColorStop(
                    1,
                    'hsl(330, 20%, ' + 40 * (0.3 + axis.rate) + '%)'
                );
            },
            getRandomValue: function (min, max) {
                return min + (max - min) * Math.random();
            },
            getAxis: function () {
                var rate = this.FOCUS_POSITION / (this.z + this.FOCUS_POSITION),
                    x = this.renderer.width / 2 + this.x * rate,
                    y = this.renderer.height / 2 - this.y * rate;
                return {
                    rate: rate,
                    x: x,
                    y: y
                };
            },
            renderCherry: function (context, axis) {
                context.beginPath();
                context.moveTo(0, 40);
                context.bezierCurveTo(-60, 20, -10, -60, 0, -20);
                context.bezierCurveTo(10, -60, 60, 20, 0, 40);
                context.fill();

                for (var i = -4; i < 4; i++) {
                    context.beginPath();
                    context.moveTo(0, 40);
                    context.quadraticCurveTo(i * 12, 10, i * 4, -24 + Math.abs(i) * 2);
                    context.stroke();
                }
            },
            render: function (context) {
                var axis = this.getAxis();

                if (
                    axis.y == this.thresholdY &&
                    this.rippleCount < this.MAX_RIPPLE_COUNT
                ) {
                    context.save();
                    context.lineWidth = 2;
                    context.strokeStyle =
                        'hsla(0, 0%, 100%, ' +
                        (this.MAX_RIPPLE_COUNT - this.rippleCount) /
                        this.MAX_RIPPLE_COUNT +
                        ')';
                    context.translate(
                        axis.x +
                        this.offsetY * axis.rate * (this.theta <= Math.PI ? -1 : 1),
                        axis.y
                    );
                    context.scale(1, 0.3);
                    context.beginPath();
                    context.arc(
                        0,
                        0,
                        (this.rippleCount / this.MAX_RIPPLE_COUNT) *
                        this.RIPPLE_RADIUS *
                        axis.rate,
                        0,
                        Math.PI * 2,
                        false
                    );
                    context.stroke();
                    context.restore();
                    this.rippleCount++;
                }
                if (axis.y < this.thresholdY || !this.endTheta || !this.endPhi) {
                    if (this.y <= 0) {
                        this.opacity = Math.min(this.opacity + 0.01, 1);
                    }
                    context.save();
                    context.globalAlpha = this.opacity;
                    context.fillStyle = this.shadowColor;
                    context.strokeStyle =
                        'hsl(330, 30%,' + 40 * (0.3 + axis.rate) + '%)';
                    context.translate(
                        axis.x,
                        Math.max(axis.y, this.thresholdY + this.thresholdY - axis.y)
                    );
                    context.rotate(Math.PI - this.theta);
                    context.scale(axis.rate * -Math.sin(this.phi), axis.rate);
                    context.translate(0, this.offsetY);
                    this.renderCherry(context, axis);
                    context.restore();
                }
                context.save();
                context.fillStyle = this.entityColor;
                context.strokeStyle = 'hsl(330, 40%,' + 70 * (0.3 + axis.rate) + '%)';
                context.translate(
                    axis.x,
                    axis.y + Math.abs(this.SINK_OFFSET * Math.sin(this.psi) * axis.rate)
                );
                context.rotate(this.theta);
                context.scale(axis.rate * Math.sin(this.phi), axis.rate);
                context.translate(0, this.offsetY);
                this.renderCherry(context, axis);
                context.restore();

                if (this.y <= -this.renderer.height / 4) {
                    if (!this.endTheta) {
                        for (
                            var theta = Math.PI / 2, end = (Math.PI * 3) / 2; theta <= end; theta += Math.PI
                        ) {
                            if (this.theta < theta && this.theta + Math.PI / 200 > theta) {
                                this.theta = theta;
                                this.endTheta = true;
                                break;
                            }
                        }
                    }
                    if (!this.endPhi) {
                        for (
                            var phi = Math.PI / 8, end = (Math.PI * 7) / 8; phi <= end; phi += (Math.PI * 3) / 4
                        ) {
                            if (this.phi < phi && this.phi + Math.PI / 200 > phi) {
                                this.phi = Math.PI / 8;
                                this.endPhi = true;
                                break;
                            }
                        }
                    }
                }
                if (!this.endTheta) {
                    if (axis.y == this.thresholdY) {
                        this.theta +=
                            (Math.PI / 200) *
                            (this.theta < Math.PI / 2 ||
                                (this.theta >= Math.PI && this.theta < (Math.PI * 3) / 2) ?
                                1 :
                                -1);
                    } else {
                        this.theta += Math.PI / 500;
                    }
                    this.theta %= Math.PI * 2;
                }
                if (this.endPhi) {
                    if (this.rippleCount == this.MAX_RIPPLE_COUNT) {
                        this.psi += this.dpsi;
                        this.psi %= Math.PI * 2;
                    }
                } else {
                    this.phi += Math.PI / (axis.y == this.thresholdY ? 200 : 500);
                    this.phi %= Math.PI;
                }
                if (this.y <= -this.renderer.height * this.SURFACE_RATE) {
                    this.x += 2;
                    this.y = -this.renderer.height * this.SURFACE_RATE;
                } else {
                    this.x += this.vx;
                    this.y += this.vy;
                }
                return (
                    this.z > -this.FOCUS_POSITION &&
                    this.z < this.FAR_LIMIT &&
                    this.x < this.renderer.width * 1.5
                );
            }
        };
        $(function () {
            console.log(6666);
            RENDERER.init();

            // è‡ªåŠ¨è§¦å‘ç›¸å†Œå±•å¼€/æ”¶èµ·æ•ˆæœï¼Œæ¯6ç§’ä¸€æ¬¡
            const box = document.querySelector('.box');
            let isExpanded = false;

            setInterval(() => {
                if (!isExpanded) {
                    // å±•å¼€ç›¸å†Œ
                    box.classList.add('active');
                    // ä¿æŒå±•å¼€çŠ¶æ€2ç§’åæ”¶èµ·
                    setTimeout(() => {
                        box.classList.remove('active');
                        isExpanded = false;
                    }, 3000);
                }
                isExpanded = true;
            }, 6000);

            /* æ˜¾ç¤ºçš„å­—å¹• */
            // 1. å®šä¹‰æ–‡æ¡ˆæ•°ç»„ï¼ˆå¯è‡ªè¡Œä¿®æ”¹ã€å¢åˆ å¥å­ï¼‰
            const loveTexts = [
				"...",
                "ä¸ƒå¤•èŠ‚å¿«ä¹ï¼ğŸ¥°ğŸ¥°ğŸ¥°ğŸ¥°ğŸ¥°ğŸ¥°ğŸ¥°",
				"æ„¿åˆ˜æ¬¢å¦¹å¦¹",
				"èº«ä½“å¥åº·",
				"å·¥ä½œé¡ºåˆ©",
				"è¶Šæ¥è¶Šæ¼‚äº®",
				"è¶Šæ¥è¶Šå¯çˆ±",
				"èƒ½æ—©æ—¥å¾—åˆ°æˆ‘"
            ];
            const subtitleEl = document.getElementById('loveSubtitle');
            let currentIndex = 0; // å½“å‰æ˜¾ç¤ºçš„å¥å­ç´¢å¼•
            const showDuration = 3500; // æ¯å¥æ˜¾ç¤ºæ—¶é—´ï¼ˆæ¯«ç§’ï¼Œ3000=3ç§’ï¼‰
            const fadeDuration = 800; // æ¸éšè¿‡æ¸¡æ—¶é—´ï¼ˆéœ€ä¸CSS transitionä¸€è‡´ï¼‰

            // 2. æ˜¾ç¤ºä¸‹ä¸€å¥çš„å‡½æ•°
            function showNextText() {
                // åˆ‡æ¢åˆ°ä¸‹ä¸€å¥ï¼ˆå¾ªç¯ï¼‰
                currentIndex = (currentIndex + 1) % loveTexts.length;
                // è®¾ç½®æ–‡å­—å†…å®¹å¹¶æ˜¾ç¤º
                subtitleEl.textContent = loveTexts[currentIndex];
                subtitleEl.style.opacity = 1;

                // 3ç§’åå¼€å§‹æ¸éš
                setTimeout(() => {
                    subtitleEl.style.opacity = 0;
                    // æ¸éšç»“æŸåï¼Œå»¶è¿Ÿ0.2ç§’å†æ˜¾ç¤ºä¸‹ä¸€å¥ï¼ˆé¿å…è¡”æ¥è¿‡å¿«ï¼‰
                    setTimeout(showNextText, fadeDuration + 200);
                }, showDuration);
            }

            // 3. é¡µé¢åŠ è½½å®Œæˆåï¼Œå…ˆå»¶è¿Ÿ1ç§’æ˜¾ç¤ºç¬¬ä¸€å¥ï¼ˆç»™3Dç›¸å†ŒåŠ è½½æ—¶é—´ï¼‰
            setTimeout(showNextText, 1000);

            const backHomeBtn = document.getElementById('backHomeBtn');
            backHomeBtn.addEventListener('click', function () {
            window.location.href = 'index.html'; // è·³è½¬è‡³é¦–é¡µ
    });
        });
    </script>
    <!-- SVG çˆ±å¿ƒæŒ‰é’® -->
    <button class="back-home-btn" id="backHomeBtn">
        <svg class="pulse-heart" width="200" height="190" viewBox="0 0 24 24" fill="#ff6b81">
            <path d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"/>
        </svg>
        <span>è¿”å›</span>
    </button>
</body>
</html>
